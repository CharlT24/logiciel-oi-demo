"use strict";exports.id=1130,exports.ids=[1130],exports.modules={1130:(e,t,a)=>{a.d(t,{Z:()=>AvatarUploader});var r=a(997),l=a(6689),o=a(9846);function AvatarUploader({userId:e,onUpload:t}){let[a,s]=(0,l.useState)(!1),handleFileChange=async a=>{let r=a.target.files?.[0];if(r&&e){s(!0);try{let a=await createImageBitmap(r),l=document.createElement("canvas");l.width=a.width,l.height=a.height;let i=l.getContext("2d");i?.drawImage(a,0,0);let c=await new Promise(e=>l.toBlob(t=>e(t),"image/jpeg",.9)),n=`avatars/${e}.jpg`,{error:d}=await o.O.storage.from("photos").upload(n,c,{upsert:!0});if(d){console.error("❌ Upload \xe9chou\xe9 :",d.message),alert("❌ Erreur lors de l'envoi de la photo."),s(!1);return}let{data:p}=o.O.storage.from("photos").getPublicUrl(n);p?.publicUrl&&t(p.publicUrl)}catch(e){console.error("❌ Erreur de conversion :",e),alert("❌ \xc9chec de traitement de l'image.")}s(!1)}};return(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx("input",{type:"file",accept:"image/*",onChange:handleFileChange,disabled:a}),a&&r.jsx("p",{className:"text-sm text-gray-500",children:"\uD83D\uDCE4 Envoi de l’image en cours..."})]})}}};