"use strict";(()=>{var e={};e.id=1744,e.ids=[1744],e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6090:e=>{e.exports=import("stripe")},9259:(e,t,r)=>{r.a(e,async(e,a)=>{try{r.r(t),r.d(t,{config:()=>d,default:()=>c,routeModule:()=>p});var s=r(1802),n=r(7153),o=r(6249),i=r(1870),u=e([i]);i=(u.then?(await u)():u)[0];let c=(0,o.l)(i,"default"),d=(0,o.l)(i,"config"),p=new s.PagesAPIRouteModule({definition:{kind:n.x.PAGES_API,page:"/api/stripe/checkout",pathname:"/api/stripe/checkout",bundlePath:"",filename:""},userland:i});a()}catch(e){a(e)}})},1870:(e,t,r)=>{r.a(e,async(e,a)=>{try{r.r(t),r.d(t,{default:()=>handler});var s=r(6090),n=e([s]);s=(n.then?(await n)():n)[0];let o=new s.default(process.env.STRIPE_SECRET_KEY,{apiVersion:"2025-04-30.basil"});async function handler(e,t){if("POST"!==e.method)return t.status(405).json({error:"M\xe9thode non autoris\xe9e"});try{let{panier:r}=e.body,a=r.map(e=>({price_data:{currency:"eur",product_data:{name:e.nom},unit_amount:Math.round(100*e.prix)},quantity:e.quantite})),s=await o.checkout.sessions.create({payment_method_types:["card"],line_items:a,mode:"payment",success_url:`${e.headers.origin}/boutique/success`,cancel_url:`${e.headers.origin}/boutique/cancel`});t.status(200).json({url:s.url})}catch(e){console.error("❌ Stripe Checkout Error:",e),t.status(500).json({error:"Erreur Stripe Checkout"})}}a()}catch(e){a(e)}})}};var t=require("../../../webpack-api-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[4222],()=>__webpack_exec__(9259));module.exports=r})();