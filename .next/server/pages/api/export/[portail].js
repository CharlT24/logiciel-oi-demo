"use strict";(()=>{var e={};e.id=311,e.ids=[311],e.modules={2885:e=>{e.exports=require("@supabase/supabase-js")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},2099:(e,r,a)=>{a.r(r),a.d(r,{config:()=>l,default:()=>u,routeModule:()=>p});var s={};a.r(s),a.d(s,{default:()=>handler});var t=a(1802),i=a(7153),n=a(6249),o=a(2678);async function handler(e,r){let{portail:a}=e.query;if(!a||"string"!=typeof a)return r.status(400).json({error:"Param\xe8tre portail manquant."});try{let{data:s,error:t}=await o.O.from("biens").select("*");if(t||!s)return console.error("❌ Erreur r\xe9cup\xe9ration biens:",t),r.status(500).json({error:"Erreur r\xe9cup\xe9ration biens."});return await o.O.from("export_logs").insert({portail:a,nb_biens:s.length,user_email:e.headers["x-user-email"]||"admin"}),console.log("⛔️ Aucun export XML g\xe9n\xe9r\xe9 — uniquement logg\xe9"),r.status(200).json({message:"✅ Export loggu\xe9. Aucun fichier XML g\xe9n\xe9r\xe9."})}catch(e){return console.error("❌ Erreur export :",e.message),r.status(500).json({error:"Erreur export : "+e.message})}}let u=(0,n.l)(s,"default"),l=(0,n.l)(s,"config"),p=new t.PagesAPIRouteModule({definition:{kind:i.x.PAGES_API,page:"/api/export/[portail]",pathname:"/api/export/[portail]",bundlePath:"",filename:""},userland:s})},2678:(e,r,a)=>{a.d(r,{O:()=>t});var s=a(2885);let t=globalThis.supabase||(0,s.createClient)("https://fkavtsofmglifzalclyn.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZrYXZ0c29mbWdsaWZ6YWxjbHluIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDI5MDgzNDIsImV4cCI6MjA1ODQ4NDM0Mn0.vN8-2RzyVu_2X4lWT4Uqa6aI3OYuAcIFFuMeGS5Po1Y")}};var r=require("../../../webpack-api-runtime.js");r.C(e);var __webpack_exec__=e=>r(r.s=e),a=r.X(0,[4222],()=>__webpack_exec__(2099));module.exports=a})();