"use strict";(()=>{var e={};e.id=379,e.ids=[379],e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},9694:(e,r,t)=>{t.r(r),t.d(r,{config:()=>c,default:()=>l,routeModule:()=>d});var n={};t.r(n),t.d(n,{default:()=>handler});var o=t(1802),s=t(7153),a=t(6249);let i=require("nodemailer");var u=t.n(i);async function handler(e,r){if("POST"!==e.method)return r.status(405).json({error:"M\xe9thode non autoris\xe9e"});try{let t=e.body,n=u().createTransport({host:process.env.SMTP_HOST,port:Number(process.env.SMTP_PORT)||587,secure:!1,auth:{user:process.env.SMTP_USER,pass:process.env.SMTP_PASS}});return await n.sendMail({from:process.env.SMTP_USER,to:"portail@example.com",subject:"\uD83D\uDCE4 Export automatique d’un bien immobilier",text:"Veuillez trouver ci-joint le fichier XML de l’annonce export\xe9e.",attachments:[{filename:"bien.xml",content:t,contentType:"application/xml"}]}),r.status(200).json({success:!0})}catch(e){return console.error("Erreur d'envoi XML :",e),r.status(500).json({error:"Erreur interne lors de l'envoi XML"})}}let l=(0,a.l)(n,"default"),c=(0,a.l)(n,"config"),d=new o.PagesAPIRouteModule({definition:{kind:s.x.PAGES_API,page:"/api/export/send",pathname:"/api/export/send",bundlePath:"",filename:""},userland:n})}};var r=require("../../../webpack-api-runtime.js");r.C(e);var __webpack_exec__=e=>r(r.s=e),t=r.X(0,[4222],()=>__webpack_exec__(9694));module.exports=t})();