"use strict";(()=>{var e={};e.id=5641,e.ids=[5641],e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},5462:e=>{e.exports=import("puppeteer")},8196:(e,t,a)=>{a.a(e,async(e,n)=>{try{a.r(t),a.d(t,{config:()=>u,default:()=>l,routeModule:()=>d});var r=a(1802),o=a(7153),i=a(6249),s=a(5791),c=e([s]);s=(c.then?(await c)():c)[0];let l=(0,i.l)(s,"default"),u=(0,i.l)(s,"config"),d=new r.PagesAPIRouteModule({definition:{kind:o.x.PAGES_API,page:"/api/leboncoin-puppeteer",pathname:"/api/leboncoin-puppeteer",bundlePath:"",filename:""},userland:s});n()}catch(e){n(e)}})},5791:(e,t,a)=>{a.a(e,async(e,n)=>{try{a.r(t),a.d(t,{default:()=>handler});var r=a(5462),o=e([r]);async function handler(e,t){let{ville:a="Lyon",min:n=1e5,max:o=5e5,type:i="maison"}=e.query,s=`https://www.leboncoin.fr/recherche?category=9&real_estate_type=${i}&locations=${a}&price=${n}-${o}`;try{let e=await r.default.launch({headless:"new",args:["--no-sandbox","--disable-setuid-sandbox"]}),a=await e.newPage();await a.setUserAgent("Mozilla/5.0 (Windows NT 10.0; Win64; x64)"),console.log("\uD83D\uDD0D Ouverture de la page Leboncoin..."),await a.goto(s,{waitUntil:"domcontentloaded",timeout:3e4}),console.log("⏳ Attente des annonces..."),await a.waitForSelector('[data-qa-id="aditem_container"]',{timeout:2e4}).catch(()=>{console.warn("⚠️ Aucune annonce d\xe9tect\xe9e – le s\xe9lecteur n'est peut-\xeatre plus \xe0 jour.")}),console.log("\uD83D\uDCE6 R\xe9cup\xe9ration des annonces...");let n=await a.evaluate(()=>{let e=document.querySelectorAll('[data-qa-id="aditem_container"]');if(!e||0===e.length)return[];let t=[];return e.forEach(e=>{let a=e.querySelector('[data-qa-id="aditem_title"]')?.innerText?.trim(),n=e.querySelector('[data-qa-id="aditem_price"]')?.innerText?.trim(),r=e.querySelector("img")?.src,o="https://www.leboncoin.fr"+e.getAttribute("href");a&&n&&o&&t.push({title:a,price:n,image:r,link:o})}),t});if(await e.close(),!n||0===n.length)return console.warn("⚠️ Aucune annonce r\xe9cup\xe9r\xe9e"),t.status(200).json({results:[],message:"Aucune annonce trouv\xe9e."});console.log(`✅ ${n.length} annonces r\xe9cup\xe9r\xe9es.`),t.status(200).json({results:n})}catch(e){console.error("❌ Erreur Puppeteer:",e.message),t.status(500).json({error:"Scraping \xe9chou\xe9",details:e.message})}}r=(o.then?(await o)():o)[0],n()}catch(e){n(e)}})}};var t=require("../../webpack-api-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),a=t.X(0,[4222],()=>__webpack_exec__(8196));module.exports=a})();