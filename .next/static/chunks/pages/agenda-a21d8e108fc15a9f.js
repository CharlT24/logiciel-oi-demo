(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8396],{9705:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/agenda",function(){return n(8485)}])},8485:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Agenda}});var s=n(5893),a=n(3299),r=n(7294);function Agenda(){let e=(0,a.useSession)(),t=null==e?void 0:e.data,[n,o]=(0,r.useState)([]),[l,c]=(0,r.useState)(null);(0,r.useEffect)(()=>{(null==t?void 0:t.accessToken)&&fetchGoogleCalendarEvents()},[t]);let fetchGoogleCalendarEvents=async()=>{try{let e=await fetch("https://www.googleapis.com/calendar/v3/calendars/primary/events?maxResults=5&orderBy=startTime&singleEvents=true",{headers:{Authorization:"Bearer ".concat(t.accessToken)}});if(!e.ok)throw Error("Erreur API Google Calendar");let n=await e.json();o(n.items||[])}catch(e){console.error("❌",e),c("Erreur lors de la r\xe9cup\xe9ration de l'agenda Google.")}};return"loading"===e.status?(0,s.jsx)("div",{className:"text-center mt-20 text-gray-500 text-sm",children:"⏳ Chargement de la session..."}):(0,s.jsxs)("div",{className:"max-w-2xl mx-auto p-8 bg-white rounded-xl shadow mt-10 space-y-6",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-orange-600",children:"\uD83D\uDCC5 Mon Agenda / Google"}),!t&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("p",{className:"text-gray-600",children:"Connecte-toi pour synchroniser ton agenda"}),(0,s.jsx)("button",{onClick:()=>(0,a.signIn)("google"),className:"bg-orange-600 text-white px-6 py-2 rounded hover:bg-orange-700 block",children:"\uD83D\uDD10 Connexion Google"}),(0,s.jsx)("button",{onClick:()=>{alert("\uD83D\uDD27 Connexion Outlook \xe0 venir (Microsoft Graph API)")},className:"bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700 block",children:"\uD83D\uDD37 Connexion Outlook"})]}),t&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("p",{className:"text-gray-600",children:["Connect\xe9 en tant que : ",(0,s.jsx)("strong",{children:t.user.email})]}),(0,s.jsx)("button",{onClick:()=>(0,a.signOut)(),className:"text-red-600 text-sm hover:underline",children:"\uD83D\uDEAA Se d\xe9connecter"}),(0,s.jsx)("hr",{}),(0,s.jsx)("h2",{className:"text-lg font-semibold",children:"\uD83D\uDCC6 \xc9v\xe9nements \xe0 venir"}),l&&(0,s.jsx)("p",{className:"text-red-500 text-sm",children:l}),n.length>0?(0,s.jsx)("ul",{className:"space-y-3 text-sm",children:n.map(e=>{var t,n,a;return(0,s.jsxs)("li",{className:"p-3 bg-orange-50 border rounded",children:[(0,s.jsxs)("p",{className:"font-semibold text-gray-800",children:["\uD83D\uDCCC ",e.summary||"(Sans titre)"]}),(0,s.jsxs)("p",{className:"text-gray-600",children:["\uD83D\uDDD3️ ",(null===(n=e.start)||void 0===n?void 0:null===(t=n.dateTime)||void 0===t?void 0:t.slice(0,16).replace("T"," "))||(null===(a=e.start)||void 0===a?void 0:a.date)]})]},e.id)})}):(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Aucun \xe9v\xe9nement trouv\xe9."})]})]})}}},function(e){e.O(0,[9774,2888,179],function(){return e(e.s=9705)}),_N_E=e.O()}]);