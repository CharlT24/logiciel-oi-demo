(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4522],{6499:function(e,a,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/utilisateur",function(){return l(6560)}])},6560:function(e,a,l){"use strict";l.r(a),l.d(a,{default:function(){return ListeUtilisateurs}});var n=l(5893),t=l(7294),s=l(9846),r=l(1664),i=l.n(r),d=l(5675),u=l.n(d);function ListeUtilisateurs(){let[e,a]=(0,t.useState)([]),[l,r]=(0,t.useState)([]),[d,c]=(0,t.useState)({nom:"",email:"",role:"agent",ville:"",telephone:"",agence_id:""}),[o,m]=(0,t.useState)(!0);(0,t.useEffect)(()=>{fetchUtilisateurs(),fetchAgences()},[]);let fetchUtilisateurs=async()=>{m(!0);let{data:e,error:l}=await s.O.from("utilisateurs").select("*, agences(nom)").order("created_at",{ascending:!1});l||a(e),m(!1)},fetchAgences=async()=>{let{data:e,error:a}=await s.O.from("agences").select("id, nom");a||r(e)},handleInputChange=e=>{let{name:a,value:l}=e.target;c(e=>({...e,[a]:l}))},handleSubmit=async e=>{e.preventDefault();let{error:a}=await s.O.from("utilisateurs").insert([d]);a?alert("❌ Erreur lors de l'ajout"):(alert("✅ Utilisateur ajout\xe9 avec succ\xe8s"),c({nom:"",email:"",role:"agent",ville:"",telephone:"",agence_id:""}),fetchUtilisateurs())};return(0,n.jsxs)("div",{className:"p-8",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold mb-6 text-orange-600",children:"\uD83D\uDC65 Utilisateurs"}),(0,n.jsxs)("form",{onSubmit:handleSubmit,className:"bg-white border rounded-xl shadow p-6 mb-10 space-y-4",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"➕ Ajouter un utilisateur"}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,n.jsx)("input",{name:"nom",value:d.nom,onChange:handleInputChange,placeholder:"Nom complet",className:"border p-2 rounded w-full",required:!0}),(0,n.jsx)("input",{name:"email",value:d.email,onChange:handleInputChange,placeholder:"Email",className:"border p-2 rounded w-full",required:!0}),(0,n.jsx)("input",{name:"ville",value:d.ville,onChange:handleInputChange,placeholder:"Ville",className:"border p-2 rounded w-full"}),(0,n.jsx)("input",{name:"telephone",value:d.telephone,onChange:handleInputChange,placeholder:"T\xe9l\xe9phone",className:"border p-2 rounded w-full"}),(0,n.jsxs)("select",{name:"role",value:d.role,onChange:handleInputChange,className:"border p-2 rounded w-full",children:[(0,n.jsx)("option",{value:"agent",children:"Agent"}),(0,n.jsx)("option",{value:"admin",children:"Admin"})]}),(0,n.jsxs)("select",{name:"agence_id",value:d.agence_id,onChange:handleInputChange,className:"border p-2 rounded w-full",children:[(0,n.jsx)("option",{value:"",children:"Aucune agence"}),l.map(e=>(0,n.jsx)("option",{value:e.id,children:e.nom},e.id))]})]}),(0,n.jsx)("button",{type:"submit",className:"bg-orange-600 text-white px-6 py-2 rounded hover:bg-orange-700",children:"Enregistrer"})]}),o?(0,n.jsx)("p",{className:"text-gray-500",children:"Chargement..."}):(0,n.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(e=>{var a;return(0,n.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-5 border",children:[(0,n.jsxs)("div",{className:"flex items-center gap-4 mb-3",children:[e.avatar_url?(0,n.jsx)(u(),{src:e.avatar_url,alt:"avatar",width:40,height:40,className:"rounded-full"}):(0,n.jsx)("div",{className:"w-10 h-10 bg-gray-200 rounded-full flex items-center justify-center text-gray-500",children:"\uD83D\uDC64"}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("p",{className:"font-semibold text-lg",children:[e.prenom," ",e.nom]}),(0,n.jsx)("p",{className:"text-sm text-gray-500",children:e.email})]})]}),(0,n.jsxs)("p",{className:"text-sm text-gray-600 mb-1",children:["\uD83C\uDFE2 Agence : ",(null===(a=e.agences)||void 0===a?void 0:a.nom)||"NC"]}),(0,n.jsxs)("p",{className:"text-sm text-gray-600 mb-1",children:["\uD83D\uDCCD Ville : ",e.ville||"NC"]}),(0,n.jsxs)("p",{className:"text-sm text-gray-600 mb-3",children:["\uD83E\uDDD1‍\uD83D\uDCBC R\xf4le : ",e.role]}),(0,n.jsx)(i(),{href:"/admin/utilisateur/".concat(e.id,"/modifier"),className:"text-sm text-orange-600 hover:underline",children:"✏️ Modifier"})]},e.id)})})]})}}},function(e){e.O(0,[1664,9774,2888,179],function(){return e(e.s=6499)}),_N_E=e.O()}]);