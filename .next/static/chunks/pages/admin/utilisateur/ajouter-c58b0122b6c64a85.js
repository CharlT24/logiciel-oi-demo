(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8074],{3729:function(e,a,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/utilisateur/ajouter",function(){return n(5141)}])},5141:function(e,a,n){"use strict";n.r(a),n.d(a,{default:function(){return AjouterUtilisateur}});var l=n(5893),t=n(7294),r=n(9846),o=n(1163);function AjouterUtilisateur(){let[e,a]=(0,t.useState)({nom:"",email:"",role:"agent",ville:"",telephone:"",agence:"",description:""}),[n,u]=(0,t.useState)(null),s=(0,o.useRouter)(),handleChange=e=>{let{name:n,value:l}=e.target;a(e=>({...e,[n]:l}))},handleSubmit=async a=>{a.preventDefault();let l=null;if(n){let e="".concat(Date.now(),"-").concat(n.name),{data:a,error:t}=await r.O.storage.from("avatars").upload(e,n);if(t){console.error("Erreur upload image :",t);return}let{data:o}=r.O.storage.from("avatars").getPublicUrl(e);l=o.publicUrl}let{error:t}=await r.O.from("utilisateurs").insert([{...e,photo_url:l,role:e.role}]);t?console.error("❌ Erreur Supabase :",t):(alert("✅ Utilisateur ajout\xe9 avec succ\xe8s !"),s.push("/admin/utilisateurs"))};return(0,l.jsxs)("div",{className:"max-w-2xl mx-auto space-y-8 bg-white shadow-md rounded-xl p-8",children:[(0,l.jsx)("h1",{className:"text-2xl font-bold text-orange-600 mb-6",children:"➕ Ajouter un utilisateur"}),(0,l.jsxs)("form",{onSubmit:handleSubmit,className:"space-y-4",children:[(0,l.jsx)("input",{type:"text",name:"nom",placeholder:"Nom complet",className:"w-full border p-2 rounded",value:e.nom,onChange:handleChange,required:!0}),(0,l.jsx)("input",{type:"email",name:"email",placeholder:"Email",className:"w-full border p-2 rounded",value:e.email,onChange:handleChange,required:!0}),(0,l.jsxs)("select",{name:"role",className:"w-full border p-2 rounded",value:e.role,onChange:handleChange,children:[(0,l.jsx)("option",{value:"agent",children:"Agent"}),(0,l.jsx)("option",{value:"admin",children:"Admin"})]}),(0,l.jsx)("input",{type:"text",name:"ville",placeholder:"Ville",className:"w-full border p-2 rounded",value:e.ville,onChange:handleChange}),(0,l.jsx)("input",{type:"text",name:"telephone",placeholder:"T\xe9l\xe9phone",className:"w-full border p-2 rounded",value:e.telephone,onChange:handleChange}),(0,l.jsx)("input",{type:"text",name:"agence",placeholder:"Nom de l’agence",className:"w-full border p-2 rounded",value:e.agence,onChange:handleChange}),(0,l.jsx)("textarea",{name:"description",placeholder:"Pr\xe9sentation ou bio",className:"w-full border p-2 rounded",rows:4,value:e.description,onChange:handleChange}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block mb-1 text-sm text-gray-600",children:"\uD83D\uDCF8 Photo de profil"}),(0,l.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{u(e.target.files[0])}})]}),(0,l.jsx)("button",{type:"submit",className:"bg-orange-600 text-white px-6 py-2 rounded hover:bg-orange-700 transition",children:"Enregistrer"})]})]})}}},function(e){e.O(0,[9774,2888,179],function(){return e(e.s=3729)}),_N_E=e.O()}]);