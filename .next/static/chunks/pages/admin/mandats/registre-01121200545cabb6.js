(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5674],{3162:function(t,n,a){var r,o;void 0!==(o="function"==typeof(r=function(){"use strict";function c(t,n,a){var r=new XMLHttpRequest;r.open("GET",t),r.responseType="blob",r.onload=function(){o(r.response,n,a)},r.onerror=function(){console.error("could not download file")},r.send()}function d(t){var n=new XMLHttpRequest;n.open("HEAD",t,!1);try{n.send()}catch(t){}return 200<=n.status&&299>=n.status}function e(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(a){var n=document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(n)}}var n="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof a.g&&a.g.global===a.g?a.g:void 0,r=n.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),o=n.saveAs||("object"!=typeof window||window!==n?function(){}:"download"in HTMLAnchorElement.prototype&&!r?function(t,a,r){var o=n.URL||n.webkitURL,s=document.createElement("a");a=a||t.name||"download",s.download=a,s.rel="noopener","string"==typeof t?(s.href=t,s.origin===location.origin?e(s):d(s.href)?c(t,a,r):e(s,s.target="_blank")):(s.href=o.createObjectURL(t),setTimeout(function(){o.revokeObjectURL(s.href)},4e4),setTimeout(function(){e(s)},0))}:"msSaveOrOpenBlob"in navigator?function(t,n,a){if(n=n||t.name||"download","string"!=typeof t){var r;navigator.msSaveOrOpenBlob((void 0===(r=a)?r={autoBom:!1}:"object"!=typeof r&&(console.warn("Deprecated: Expected third argument to be a object"),r={autoBom:!r}),r.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\uFEFF",t],{type:t.type}):t),n)}else if(d(t))c(t,n,a);else{var o=document.createElement("a");o.href=t,o.target="_blank",setTimeout(function(){e(o)})}}:function(t,a,o,s){if((s=s||open("","_blank"))&&(s.document.title=s.document.body.innerText="downloading..."),"string"==typeof t)return c(t,a,o);var i="application/octet-stream"===t.type,l=/constructor/i.test(n.HTMLElement)||n.safari,p=/CriOS\/[\d]+/.test(navigator.userAgent);if((p||i&&l||r)&&"undefined"!=typeof FileReader){var u=new FileReader;u.onloadend=function(){var t=u.result;t=p?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),s?s.location.href=t:location=t,s=null},u.readAsDataURL(t)}else{var m=n.URL||n.webkitURL,h=m.createObjectURL(t);s?s.location=h:location.href=h,s=null,setTimeout(function(){m.revokeObjectURL(h)},4e4)}});n.saveAs=o.saveAs=o,t.exports=o})?r.apply(n,[]):r)&&(t.exports=o)},2971:function(t,n,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/mandats/registre",function(){return a(7786)}])},7786:function(t,n,a){"use strict";a.r(n),a.d(n,{default:function(){return RegistreMandats}});var r=a(5893),o=a(7294),s=a(9846),i=a(1484),l=a(3162);function RegistreMandats(){let[t,n]=(0,o.useState)([]);(0,o.useEffect)(()=>{fetchMandats()},[]);let fetchMandats=async()=>{let{data:t,error:a}=await s.O.from("registres_mandats").select("*").eq("statut","valide").order("date_validation",{ascending:!1});a||n(t)},generateWordDoc=async()=>{let n=[new i.SCH({children:["Num\xe9ro","Ville","Code Postal","Type Bien","Nom","Pr\xe9nom","Adresse Propri\xe9taire","Adresse Bien","Statut","Date Validation"].map(t=>new i.pj1({children:[new i.nvN({text:t,bold:!0})],width:{size:10,type:i.Y1N.PERCENTAGE}}))}),...t.map(t=>new i.SCH({children:[t.numero_mandat,t.ville,t.code_postal,t.type_bien,t.proprietaire_nom,t.proprietaire_prenom,t.adresse_proprietaire,t.adresse_bien,t.statut,t.date_validation?new Date(t.date_validation).toLocaleDateString():"-"].map(t=>new i.pj1({children:[new i.nvN(String(t))],width:{size:10,type:i.Y1N.PERCENTAGE}}))}))],a=new i.BBB({sections:[{children:[new i.nvN({text:"Registre des Mandats Valid\xe9s",heading:"Heading1"}),new i.iA_({rows:n})]}]}),r=await i.UDs.toBlob(a);(0,l.saveAs)(r,"registre-mandats-".concat(new Date().toLocaleDateString(),".docx"))};return(0,r.jsxs)("div",{className:"max-w-7xl mx-auto py-10 px-6 space-y-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-orange-600",children:"\uD83D\uDCDC Registre des Mandats Valid\xe9s"}),(0,r.jsx)("button",{onClick:generateWordDoc,className:"bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-xl text-sm",children:"\uD83D\uDCC4 Exporter Word"})]}),0===t.length?(0,r.jsx)("p",{className:"text-gray-500",children:"Aucun mandat valid\xe9 pour l'instant."}):(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full border text-sm",children:[(0,r.jsx)("thead",{className:"bg-orange-100",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"border p-2",children:"#"}),(0,r.jsx)("th",{className:"border p-2",children:"Ville"}),(0,r.jsx)("th",{className:"border p-2",children:"Code Postal"}),(0,r.jsx)("th",{className:"border p-2",children:"Type Bien"}),(0,r.jsx)("th",{className:"border p-2",children:"Nom Propri\xe9taire"}),(0,r.jsx)("th",{className:"border p-2",children:"Pr\xe9nom Propri\xe9taire"}),(0,r.jsx)("th",{className:"border p-2",children:"Adresse Propri\xe9taire"}),(0,r.jsx)("th",{className:"border p-2",children:"Adresse Bien"}),(0,r.jsx)("th",{className:"border p-2",children:"Statut"}),(0,r.jsx)("th",{className:"border p-2",children:"Date Validation"})]})}),(0,r.jsx)("tbody",{children:t.map(t=>(0,r.jsxs)("tr",{className:"hover:bg-orange-50",children:[(0,r.jsx)("td",{className:"border p-2 text-center font-bold",children:t.numero_mandat}),(0,r.jsx)("td",{className:"border p-2",children:t.ville}),(0,r.jsx)("td",{className:"border p-2",children:t.code_postal}),(0,r.jsx)("td",{className:"border p-2",children:t.type_bien}),(0,r.jsx)("td",{className:"border p-2",children:t.proprietaire_nom}),(0,r.jsx)("td",{className:"border p-2",children:t.proprietaire_prenom}),(0,r.jsx)("td",{className:"border p-2",children:t.adresse_proprietaire}),(0,r.jsx)("td",{className:"border p-2",children:t.adresse_bien}),(0,r.jsx)("td",{className:"border p-2 text-center",children:t.statut}),(0,r.jsx)("td",{className:"border p-2",children:t.date_validation?new Date(t.date_validation).toLocaleDateString():"-"})]},t.id))})]})})]})}}},function(t){t.O(0,[1381,9774,2888,179],function(){return t(t.s=2971)}),_N_E=t.O()}]);