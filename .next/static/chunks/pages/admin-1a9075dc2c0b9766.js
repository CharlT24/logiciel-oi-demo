(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6964],{8195:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin",function(){return s(2406)}])},2406:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return AdminPage}});var n=s(5893),a=s(7294),r=s(9846),i=s(1163);function AdminPage(){let e=(0,i.useRouter)(),[t,s]=(0,a.useState)(!1),[o,l]=(0,a.useState)(!1),[d,u]=(0,a.useState)(!1),[c,h]=(0,a.useState)([]);(0,a.useEffect)(()=>{let checkAdmin=async()=>{var e,t,n;let a=await r.O.auth.getSession(),i=null===(n=a.data)||void 0===n?void 0:null===(t=n.session)||void 0===t?void 0:null===(e=t.user)||void 0===e?void 0:e.id;if(!i)return;let{data:o}=await r.O.from("utilisateurs").select("role").eq("id",i).single();(null==o?void 0:o.role)==="admin"&&s(!0)};checkAdmin()},[]);let handleUpload=async e=>{let t=e.target.files[0];if(!t)return;l(!0),u(!1);let s="".concat(Date.now(),"_").concat(t.name),{error:n}=await r.O.storage.from("documents").upload(s,t);n?alert("❌ Erreur lors de l’upload"):(u(!0),fetchDocuments()),l(!1)},handleDelete=async e=>{let{error:t}=await r.O.storage.from("documents").remove([e]);t?alert("❌ Erreur lors de la suppression"):(alert("✅ Fichier supprim\xe9 avec succ\xe8s"),fetchDocuments())},getPublicUrl=e=>r.O.storage.from("documents").getPublicUrl(e).data.publicUrl,fetchDocuments=async()=>{let{data:e,error:t}=await r.O.storage.from("documents").list("",{limit:100});t?console.error("Erreur r\xe9cup\xe9ration fichiers :",t):h(e)};return(0,n.jsxs)("div",{className:"p-6 max-w-3xl mx-auto",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"⚙️ Espace Administration"}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,n.jsx)("button",{onClick:()=>e.push("/admin/parametres/utilisateurs"),className:"bg-orange-500 text-white px-5 py-4 rounded shadow hover:bg-orange-600 transition",children:"\uD83D\uDC65 G\xe9rer les utilisateurs"}),(0,n.jsx)("button",{onClick:()=>e.push("/admin/export"),className:"bg-blue-500 text-white px-5 py-4 rounded shadow hover:bg-blue-600 transition",children:"\uD83C\uDF0D Plateformes d’export"}),(0,n.jsx)("button",{onClick:()=>e.push("/admin/site"),className:"bg-green-500 text-white px-5 py-4 rounded shadow hover:bg-green-600 transition",children:"\uD83D\uDDA5️ Gestion du site vitrine"}),(0,n.jsx)("button",{onClick:()=>e.push("/admin/pdf"),className:"bg-red-500 text-white px-5 py-4 rounded shadow hover:bg-red-600 transition",children:"\uD83D\uDCF0 Uploader une newsletter"}),(0,n.jsx)("button",{onClick:()=>e.push("/admin/crm"),className:"bg-purple-500 text-white px-5 py-4 rounded shadow hover:bg-purple-600 transition",children:"\uD83D\uDEE0️ Personnalisation CRM"}),t&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("button",{onClick:()=>e.push("/admin/documents"),className:"bg-yellow-500 text-white px-5 py-4 rounded shadow hover:bg-yellow-600 transition",children:"\uD83D\uDCC1 Gestion des documents"}),(0,n.jsx)("button",{onClick:()=>e.push("/admin/boutique"),className:"bg-pink-500 text-white px-5 py-4 rounded shadow hover:bg-pink-600 transition",children:"\uD83D\uDED2 G\xe9rer la boutique"}),(0,n.jsx)("button",{onClick:()=>e.push("/admin/agences/ajouter"),className:"bg-indigo-500 text-white px-5 py-4 rounded shadow hover:bg-indigo-600 transition",children:"\uD83C\uDFE2 Cr\xe9er une agence"}),(0,n.jsx)("button",{onClick:()=>e.push("/admin/mandats"),className:"bg-teal-500 text-white px-5 py-4 rounded shadow hover:bg-teal-600 transition",children:"\uD83D\uDCDC Registre des mandats"})]})]}),t&&(0,n.jsxs)("div",{className:"mt-10 bg-white p-6 border rounded-xl shadow space-y-4",children:[(0,n.jsx)("h2",{className:"text-lg font-bold text-orange-700",children:"Uploader un fichier (PDF/Word)"}),(0,n.jsx)("input",{type:"file",accept:".pdf,.doc,.docx",onChange:handleUpload,className:"text-sm"}),o&&(0,n.jsx)("p",{className:"text-sm text-gray-400",children:"Envoi en cours..."}),d&&(0,n.jsx)("p",{className:"text-sm text-green-600",children:"✅ Document ajout\xe9 avec succ\xe8s"})]}),t&&(0,n.jsxs)("div",{className:"mt-10",children:[(0,n.jsx)("h2",{className:"text-xl font-bold text-gray-800",children:"Documents existants"}),0===c.length?(0,n.jsx)("p",{className:"text-gray-500",children:"Aucun document disponible."}):(0,n.jsx)("div",{className:"space-y-4 mt-4",children:c.map(e=>(0,n.jsxs)("div",{className:"flex justify-between items-center border p-4 rounded-lg shadow hover:bg-gray-50 transition",children:[(0,n.jsx)("p",{className:"text-gray-700",children:e.name}),(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)("a",{href:getPublicUrl(e.name),target:"_blank",rel:"noopener noreferrer",className:"text-orange-600 hover:underline",children:"\uD83D\uDCE5 T\xe9l\xe9charger"}),(0,n.jsx)("button",{onClick:()=>handleDelete(e.name),className:"text-red-600 hover:underline",children:"\uD83D\uDDD1️ Supprimer"})]})]},e.name))})]})]})}}},function(e){e.O(0,[9774,2888,179],function(){return e(e.s=8195)}),_N_E=e.O()}]);