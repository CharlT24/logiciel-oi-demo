(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[812],{6315:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/clients/acquereurs",function(){return s(9198)}])},9198:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return Acquereurs}});var l=s(5893),r=s(7294),a=s(9846),n=s(1664),c=s.n(n),u=s(1163);function Acquereurs(){let[e,t]=(0,r.useState)([]),[s,n]=(0,r.useState)([]),[i,d]=(0,r.useState)(""),[o,x]=(0,r.useState)(null),[m,h]=(0,r.useState)(!1),f=(0,u.useRouter)();(0,r.useEffect)(()=>{let fetchData=async()=>{var e,s;let{data:l}=await a.O.auth.getSession(),r=null==l?void 0:null===(s=l.session)||void 0===s?void 0:null===(e=s.user)||void 0===e?void 0:e.id;if(x(r),r){let{data:e}=await a.O.from("utilisateurs").select("role").eq("id",r).single();(null==e?void 0:e.role)==="admin"&&h(!0)}let{data:c,error:u}=await a.O.from("clients").select("*").order("created_at",{ascending:!1});!u&&c&&(t(c),n(c))};fetchData()},[]),(0,r.useEffect)(()=>{let t=i.toLowerCase(),s=e.filter(e=>{var s;let l=null===(s=e.nom)||void 0===s?void 0:s.toLowerCase().includes(t),r=(e.mots_cles||[]).some(e=>e.toLowerCase().includes(t));return l||r});n(s)},[i,e]);let handleDelete=async e=>{if(!confirm("Supprimer cet acqu\xe9reur ?"))return;let{error:s}=await a.O.from("clients").delete().eq("id",e);s||t(t=>t.filter(t=>t.id!==e))};return(0,l.jsxs)("div",{className:"space-y-10 max-w-6xl mx-auto px-6 py-10",children:[(0,l.jsx)("button",{type:"button",onClick:()=>f.back(),className:"text-sm text-orange-600 hover:underline mb-2",children:"← Retour"}),(0,l.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[(0,l.jsx)("h1",{className:"text-2xl font-bold text-orange-600",children:"\uD83D\uDC65 Acqu\xe9reurs"}),(0,l.jsx)("input",{type:"text",value:i,onChange:e=>d(e.target.value),placeholder:"\uD83D\uDD0E Rechercher (nom, mot-cl\xe9...)",className:"border px-3 py-2 rounded-md text-sm w-full md:w-80"}),(0,l.jsx)(c(),{href:"/clients/acquereurs/ajouter",children:(0,l.jsx)("button",{className:"bg-orange-600 text-white px-4 py-2 rounded hover:bg-orange-700 text-sm",children:"➕ Ajouter un acqu\xe9reur"})})]}),0===s.length?(0,l.jsx)("p",{className:"text-gray-500",children:"Aucun acqu\xe9reur trouv\xe9."}):(0,l.jsx)("div",{className:"grid md:grid-cols-2 xl:grid-cols-3 gap-6",children:s.map(e=>{var t;return(0,l.jsxs)("div",{className:"bg-white rounded-xl shadow p-5 border relative space-y-2",children:[(0,l.jsxs)("div",{className:"flex justify-between items-start",children:[(0,l.jsx)("h2",{className:"text-lg font-bold text-gray-800",children:e.nom}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(m||o===e.created_by)&&(0,l.jsx)("button",{onClick:()=>f.push("/clients/acquereurs/modifier/".concat(e.id)),className:"text-blue-600 hover:text-blue-800 text-sm",children:"\uD83D\uDCDD"}),m&&(0,l.jsx)("button",{onClick:()=>handleDelete(e.id),className:"text-red-600 hover:text-red-800 text-sm",children:"\uD83D\uDDD1"})]})]}),(0,l.jsxs)("p",{className:"text-sm text-gray-600",children:["\uD83D\uDCCD ",e.ville_recherche||"Ville non pr\xe9cis\xe9e"]}),(0,l.jsxs)("p",{className:"text-sm text-gray-600",children:["\uD83D\uDCB0 Budget : ",e.budget_min||0," € → ",e.budget_max||"Max"," €"]}),(0,l.jsxs)("p",{className:"text-sm text-gray-600",children:["\uD83C\uDFE1 Recherche : ",e.type_bien||"Non sp\xe9cifi\xe9"]}),(null===(t=e.mots_cles)||void 0===t?void 0:t.length)>0&&(0,l.jsx)("div",{className:"flex flex-wrap gap-1 text-xs text-orange-600",children:e.mots_cles.map((e,t)=>(0,l.jsx)("span",{className:"bg-orange-100 px-2 py-0.5 rounded-full",children:e},t))}),(0,l.jsx)(c(),{href:"/clients/acquereurs/".concat(e.id),className:"text-sm text-blue-600 hover:underline block mt-2",children:"Voir la fiche ➜"})]},e.id)})})]})}}},function(e){e.O(0,[1664,9774,2888,179],function(){return e(e.s=6315)}),_N_E=e.O()}]);