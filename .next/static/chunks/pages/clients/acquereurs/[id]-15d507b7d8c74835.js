(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3434],{1830:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/clients/acquereurs/[id]",function(){return t(3259)}])},3259:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return FicheAcquereur}});var i=t(5893),n=t(1163),r=t(7294),l=t(9846),c=t(1664),a=t.n(c);function FicheAcquereur(){var e,s;let t=(0,n.useRouter)(),{id:c}=t.query,[d,u]=(0,r.useState)(null),[o,x]=(0,r.useState)([]),[h,m]=(0,r.useState)(null);(0,r.useEffect)(()=>{let fetchSession=async()=>{let e=await l.O.auth.getSession();m(e.data.session)},fetchData=async()=>{if(!c)return;let{data:e}=await l.O.from("clients").select("*").eq("id",c).single();u(e);let{data:s}=await l.O.from("visites").select("date_visite, biens(titre)").eq("client_id",c).order("date_visite",{ascending:!1});x(s||[])};fetchSession(),fetchData()},[c]);let supprimerClient=async()=>{window.confirm("Supprimer d\xe9finitivement cet acqu\xe9reur ?")&&(await l.O.from("clients").delete().eq("id",c),alert("Client supprim\xe9 ✅"),t.push("/clients/acquereur"))};if(!d)return(0,i.jsx)("p",{className:"text-center mt-10",children:"Chargement..."});let p=(null==h?void 0:null===(s=h.user)||void 0===s?void 0:null===(e=s.user_metadata)||void 0===e?void 0:e.role)==="admin";return(0,i.jsxs)("div",{className:"max-w-4xl mx-auto p-6 space-y-6",children:[(0,i.jsx)("h1",{className:"text-2xl font-bold text-orange-600",children:"\uD83D\uDC64 Fiche Acqu\xe9reur"}),(0,i.jsxs)("div",{className:"bg-white p-4 rounded-xl shadow space-y-2",children:[(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Nom :"})," ",d.nom]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Email :"})," ",d.email]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"T\xe9l\xe9phone :"})," ",d.telephone]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Ville recherch\xe9e :"})," ",d.ville_recherche]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Budget :"})," ",d.budget_min," € – ",d.budget_max," €"]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Surface min :"})," ",d.surface_min," m\xb2"]}),d.mots_cles&&d.mots_cles.length>0&&(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{children:(0,i.jsx)("strong",{children:"Mots-cl\xe9s :"})}),(0,i.jsx)("div",{className:"flex flex-wrap gap-2 mt-1",children:d.mots_cles.map((e,s)=>(0,i.jsx)("span",{className:"bg-orange-100 px-3 py-1 rounded-full text-sm",children:e},s))})]})]}),(0,i.jsxs)("div",{className:"bg-white p-4 rounded-xl shadow space-y-2",children:[(0,i.jsx)("h2",{className:"text-lg font-semibold text-orange-700 mb-2",children:"\uD83D\uDCCD Visites enregistr\xe9es"}),0===o.length?(0,i.jsx)("p",{className:"text-sm text-gray-500",children:"Aucune visite encore enregistr\xe9e."}):(0,i.jsx)("ul",{className:"list-disc pl-5 space-y-1 text-sm text-gray-700",children:o.map((e,s)=>{var t;return(0,i.jsxs)("li",{children:[(null===(t=e.biens)||void 0===t?void 0:t.titre)||"Bien inconnu"," — ",new Date(e.date_visite).toLocaleDateString()]},s)})})]}),p&&(0,i.jsx)("div",{className:"text-right",children:(0,i.jsx)("button",{onClick:supprimerClient,className:"text-sm text-red-600 hover:underline",children:"❌ Supprimer cet acqu\xe9reur"})}),(0,i.jsx)(a(),{href:"/clients/acquereur",className:"text-sm text-orange-600 hover:underline block",children:"⬅️ Retour \xe0 la liste"})]})}}},function(e){e.O(0,[1664,9774,2888,179],function(){return e(e.s=1830)}),_N_E=e.O()}]);