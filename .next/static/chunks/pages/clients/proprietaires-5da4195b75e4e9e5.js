(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8277],{8678:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/clients/proprietaires",function(){return r(9146)}])},9146:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return ListeProprietaires}});var s=r(5893),i=r(7294),a=r(9846),l=r(1664),n=r.n(l),o=r(1163);function ListeProprietaires(){let[e,t]=(0,i.useState)([]),[r,l]=(0,i.useState)(!0),[c,u]=(0,i.useState)(null),[d,p]=(0,i.useState)(!1),x=(0,o.useRouter)();(0,i.useEffect)(()=>{let fetchSession=async()=>{var e,t;let{data:r}=await a.O.auth.getSession(),s=null==r?void 0:null===(t=r.session)||void 0===t?void 0:null===(e=t.user)||void 0===e?void 0:e.id;if(u(s),s){let{data:e}=await a.O.from("utilisateurs").select("role").eq("id",s).single();(null==e?void 0:e.role)==="admin"&&p(!0)}},fetchProprietaires=async()=>{let{data:e,error:r}=await a.O.from("proprietaires").select("*");r?console.error("Erreur Supabase:",r):t(e),l(!1)};fetchSession(),fetchProprietaires()},[]);let handleDelete=async e=>{if(!confirm("Supprimer ce propri\xe9taire ?"))return;let{error:r}=await a.O.from("proprietaires").delete().eq("id",e);r?(alert("Erreur lors de la suppression"),console.error(r)):t(t=>t.filter(t=>t.id!==e))};return r?(0,s.jsx)("p",{className:"p-10 text-center",children:"Chargement..."}):(0,s.jsxs)("div",{className:"max-w-6xl mx-auto px-6 py-10 space-y-6",children:[(0,s.jsx)("button",{type:"button",onClick:()=>x.back(),className:"text-sm text-orange-600 hover:underline",children:"← Retour"}),(0,s.jsx)("h1",{className:"text-3xl font-bold text-orange-600",children:"\uD83D\uDCCB Liste des propri\xe9taires"}),0===e.length?(0,s.jsx)("p",{className:"text-gray-500 mt-10",children:"Aucun propri\xe9taire trouv\xe9."}):(0,s.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6",children:e.map(e=>(0,s.jsxs)("div",{className:"bg-white p-4 rounded-xl shadow space-y-2 relative",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-800",children:e.nom}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:e.email}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:e.telephone}),(0,s.jsx)(n(),{href:"/clients/proprietaires/".concat(e.id),className:"text-orange-600 hover:underline text-sm",children:"Voir la fiche"}),d&&(0,s.jsx)("button",{onClick:()=>handleDelete(e.id),className:"absolute top-3 right-3 text-red-600 hover:text-red-800 text-sm",children:"\uD83D\uDDD1"})]},e.id))})]})}}},function(e){e.O(0,[1664,9774,2888,179],function(){return e(e.s=8678)}),_N_E=e.O()}]);