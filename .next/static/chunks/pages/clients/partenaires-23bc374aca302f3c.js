(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7525],{9470:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/clients/partenaires",function(){return r(4333)}])},4333:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return PartenairesIndex}});var a=r(5893),s=r(7294),i=r(9846),n=r(1664),l=r.n(n),o=r(1163);function PartenairesIndex(){let[e,t]=(0,s.useState)([]),[r,n]=(0,s.useState)([]),[u,c]=(0,s.useState)(""),[d,x]=(0,s.useState)(""),[h,p]=(0,s.useState)(null),[m,v]=(0,s.useState)(!1),f=(0,o.useRouter)();(0,s.useEffect)(()=>{let fetchUser=async()=>{var e,t;let{data:r}=await i.O.auth.getSession(),a=null==r?void 0:null===(t=r.session)||void 0===t?void 0:null===(e=t.user)||void 0===e?void 0:e.id;if(p(a),a){let{data:e}=await i.O.from("utilisateurs").select("role").eq("id",a).single();(null==e?void 0:e.role)==="admin"&&v(!0)}},fetchPartenaires=async()=>{let{data:e,error:r}=await i.O.from("partenaires").select("*").order("created_at",{ascending:!1});r||(t(e),n(e))};fetchUser(),fetchPartenaires()},[]);let handleDelete=async e=>{if(!confirm("Supprimer ce partenaire ?"))return;let{error:r}=await i.O.from("partenaires").delete().eq("id",e);r||(t(t=>t.filter(t=>t.id!==e)),n(t=>t.filter(t=>t.id!==e)))},applyFilters=()=>{let t=[...e];u&&(t=t.filter(e=>{var t;return null===(t=e.ville)||void 0===t?void 0:t.toLowerCase().includes(u.toLowerCase())})),d&&(t=t.filter(e=>{var t;return(null===(t=e.type)||void 0===t?void 0:t.toLowerCase())===d.toLowerCase()})),n(t)};return(0,s.useEffect)(()=>{applyFilters()},[u,d]),(0,a.jsxs)("div",{className:"max-w-6xl mx-auto px-6 py-10 space-y-6",children:[(0,a.jsx)("button",{type:"button",onClick:()=>f.back(),className:"text-sm text-orange-600 hover:underline",children:"← Retour"}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-orange-600",children:"\uD83E\uDD1D Partenaires"}),(0,a.jsx)(l(),{href:"/clients/partenaires/ajouter",children:(0,a.jsx)("button",{className:"bg-orange-600 text-white px-4 py-2 rounded hover:bg-orange-700 text-sm",children:"➕ Ajouter un partenaire"})})]}),(0,a.jsxs)("div",{className:"flex gap-4 flex-wrap",children:[(0,a.jsx)("input",{type:"text",placeholder:"Filtrer par ville...",className:"border p-2 rounded w-64",value:u,onChange:e=>c(e.target.value)}),(0,a.jsxs)("select",{className:"border p-2 rounded w-64",value:d,onChange:e=>x(e.target.value),children:[(0,a.jsx)("option",{value:"",children:"Tous les types"}),(0,a.jsx)("option",{value:"Notaire",children:"Notaire"}),(0,a.jsx)("option",{value:"Diagnostiqueur",children:"Diagnostiqueur"}),(0,a.jsx)("option",{value:"Courtier",children:"Courtier"}),(0,a.jsx)("option",{value:"Architecte",children:"Architecte"}),(0,a.jsx)("option",{value:"Promoteur",children:"Promoteur"}),(0,a.jsx)("option",{value:"Constructeur",children:"Constructeur"}),(0,a.jsx)("option",{value:"G\xe9om\xe8tre",children:"G\xe9om\xe8tre"}),(0,a.jsx)("option",{value:"Avocat",children:"Avocat"}),(0,a.jsx)("option",{value:"Home staging",children:"Home staging"}),(0,a.jsx)("option",{value:"Travaux",children:"Travaux"}),(0,a.jsx)("option",{value:"Gestionnaire",children:"Gestionnaire"})]})]}),0===r.length?(0,a.jsx)("p",{className:"text-gray-500",children:"Aucun partenaire trouv\xe9."}):(0,a.jsx)("div",{className:"grid md:grid-cols-2 xl:grid-cols-3 gap-6",children:r.map(e=>(0,a.jsxs)("div",{className:"bg-white p-4 rounded-xl shadow space-y-2 relative",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-800",children:e.nom}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["\uD83D\uDCCD ",e.ville]}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["\uD83C\uDFF7️ ",e.type]}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["\uD83D\uDCDE ",e.telephone]}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["\uD83D\uDCE7 ",e.email]}),(0,a.jsx)(l(),{href:"/clients/partenaires/".concat(e.id),className:"text-orange-600 hover:underline text-sm",children:"Voir la fiche ➜"}),(m||h===e.created_by)&&(0,a.jsx)("button",{onClick:()=>f.push("/clients/partenaires/modifier/".concat(e.id)),className:"absolute top-3 right-8 text-blue-600 hover:text-blue-800 text-sm",children:"\uD83D\uDCDD"}),m&&(0,a.jsx)("button",{onClick:()=>handleDelete(e.id),className:"absolute top-3 right-3 text-red-600 hover:text-red-800 text-sm",children:"\uD83D\uDDD1"})]},e.id))})]})}}},function(e){e.O(0,[1664,9774,2888,179],function(){return e(e.s=9470)}),_N_E=e.O()}]);